<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-08-03T23:49:07.7299944"><title>DataX Transformer | datax</title><script type="application/json" id="virtual-toc-data">[{"id":"transformer","level":0,"title":"Transformer定义","anchor":"#transformer"},{"id":"-sbnubc_4","level":0,"title":"运行模型","anchor":"#-sbnubc_4"},{"id":"udf","level":0,"title":"UDF手册","anchor":"#udf"},{"id":"job","level":0,"title":"Job定义","anchor":"#job"},{"id":"-sbnubc_7","level":0,"title":"计量和脏数据","anchor":"#-sbnubc_7"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="DataX Transformer | datax"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="datax Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/datax/datax-5-transformer.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="DataX Transformer | datax"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/datax/datax-5-transformer.html#webpage",
    "url": "writerside-documentation/datax/datax-5-transformer.html",
    "name": "DataX Transformer | datax",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/datax/#website",
    "url": "writerside-documentation/datax/",
    "name": "datax Help"
}</script><!-- End Schema.org --></head><body data-id="datax【5】transformer" data-main-title="DataX Transformer" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>datax  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="datax【5】transformer" id="datax【5】transformer.md">DataX Transformer</h1><section class="chapter"><h2 id="transformer" data-toc="transformer">Transformer定义</h2><p id="-sbnubc_8">在数据同步、传输过程中，存在用户对于数据传输进行特殊定制化的需求场景，包括裁剪列、转换列等工作，可以借助ETL的T过程实现(Transformer)。DataX包含了完整的E(Extract)、T(Transformer)、L(Load)支持。</p></section><section class="chapter"><h2 id="-sbnubc_4" data-toc="-sbnubc_4">运行模型</h2><figure id="-sbnubc_9"><img alt="alt text" src="images/image.png" title="alt text" width="617" height="416"></figure></section><section class="chapter"><h2 id="udf" data-toc="udf">UDF手册</h2><ol class="list _decimal" id="-sbnubc_10" type="1"><li class="list__item" id="-sbnubc_30"><p id="-sbnubc_31">dx_substr</p></li></ol><ul class="list _bullet" id="-sbnubc_11"><li class="list__item" id="-sbnubc_32"><p id="-sbnubc_35">参数：3个</p><ul class="list _bullet" id="-sbnubc_36"><li class="list__item" id="-sbnubc_37"><p id="-sbnubc_40">第一个参数：字段编号，对应record中第几个字段。</p></li><li class="list__item" id="-sbnubc_38"><p id="-sbnubc_41">第二个参数：字段值的开始位置。</p></li><li class="list__item" id="-sbnubc_39"><p id="-sbnubc_42">第三个参数：目标字段长度。</p></li></ul></li><li class="list__item" id="-sbnubc_33"><p id="-sbnubc_43">返回： 从字符串的指定位置（包含）截取指定长度的字符串。如果开始位置非法抛出异常。如果字段为空值，直接返回（即不参与本transformer）</p></li><li class="list__item" id="-sbnubc_34"><p id="-sbnubc_44">举例：</p></li></ul><div class="code-block" data-lang="none">
dx_substr(1,&quot;2&quot;,&quot;5&quot;)  column 1的value为“dataxTest”=&gt;&quot;taxTe&quot;
dx_substr(1,&quot;5&quot;,&quot;10&quot;)  column 1的value为“dataxTest”=&gt;&quot;Test&quot;
</div><ol class="list _decimal" id="-sbnubc_13" type="1" start="2"><li class="list__item" id="-sbnubc_45"><p id="-sbnubc_46">dx_pad</p></li></ol><ul class="list _bullet" id="-sbnubc_14"><li class="list__item" id="-sbnubc_47"><p id="-sbnubc_50">参数：4个</p><ul class="list _bullet" id="-sbnubc_51"><li class="list__item" id="-sbnubc_52"><p id="-sbnubc_56">第一个参数：字段编号，对应record中第几个字段。</p></li><li class="list__item" id="-sbnubc_53"><p id="-sbnubc_57">第二个参数：&quot;l&quot;,&quot;r&quot;, 指示是在头进行pad，还是尾进行pad。</p></li><li class="list__item" id="-sbnubc_54"><p id="-sbnubc_58">第三个参数：目标字段长度。</p></li><li class="list__item" id="-sbnubc_55"><p id="-sbnubc_59">第四个参数：需要pad的字符。</p></li></ul></li><li class="list__item" id="-sbnubc_48"><p id="-sbnubc_60">返回： 如果源字符串长度小于目标字段长度，按照位置添加pad字符后返回。如果长于，直接截断（都截右边）。如果字段为空值，转换为空字符串进行pad，即最后的字符串全是需要pad的字符</p></li><li class="list__item" id="-sbnubc_49"><p id="-sbnubc_61">举例：</p></li></ul><div class="code-block" data-lang="none">
         dx_pad(1,&quot;l&quot;,&quot;4&quot;,&quot;A&quot;), 如果column 1 的值为 xyz=&gt; Axyz， 值为 xyzzzzz =&gt; xyzz
         dx_pad(1,&quot;r&quot;,&quot;4&quot;,&quot;A&quot;), 如果column 1 的值为 xyz=&gt; xyzA， 值为 xyzzzzz =&gt; xyzz
</div><ol class="list _decimal" id="-sbnubc_16" type="1" start="3"><li class="list__item" id="-sbnubc_62"><p id="-sbnubc_63">dx_replace</p></li></ol><ul class="list _bullet" id="-sbnubc_17"><li class="list__item" id="-sbnubc_64"><p id="-sbnubc_67">参数：4个</p><ul class="list _bullet" id="-sbnubc_68"><li class="list__item" id="-sbnubc_69"><p id="-sbnubc_73">第一个参数：字段编号，对应record中第几个字段。</p></li><li class="list__item" id="-sbnubc_70"><p id="-sbnubc_74">第二个参数：字段值的开始位置。</p></li><li class="list__item" id="-sbnubc_71"><p id="-sbnubc_75">第三个参数：需要替换的字段长度。</p></li><li class="list__item" id="-sbnubc_72"><p id="-sbnubc_76">第四个参数：需要替换的字符串。</p></li></ul></li><li class="list__item" id="-sbnubc_65"><p id="-sbnubc_77">返回： 从字符串的指定位置（包含）替换指定长度的字符串。如果开始位置非法抛出异常。如果字段为空值，直接返回（即不参与本transformer）</p></li><li class="list__item" id="-sbnubc_66"><p id="-sbnubc_78">举例：</p></li></ul><div class="code-block" data-lang="none">
dx_replace(1,&quot;2&quot;,&quot;4&quot;,&quot;****&quot;)  column 1的value为“dataxTest”=&gt;&quot;da****est&quot;
dx_replace(1,&quot;5&quot;,&quot;10&quot;,&quot;****&quot;)  column 1的value为“dataxTest”=&gt;&quot;datax****&quot;
</div><ol class="list _decimal" id="-sbnubc_19" type="1" start="4"><li class="list__item" id="-sbnubc_79"><p id="-sbnubc_80">dx_filter （关联filter暂不支持，即多个字段的联合判断，函参太过复杂，用户难以使用。）</p></li></ol><ul class="list _bullet" id="-sbnubc_20"><li class="list__item" id="-sbnubc_81"><p id="-sbnubc_84">参数：</p><ul class="list _bullet" id="-sbnubc_85"><li class="list__item" id="-sbnubc_86"><p id="-sbnubc_89">第一个参数：字段编号，对应record中第几个字段。</p></li><li class="list__item" id="-sbnubc_87"><p id="-sbnubc_90">第二个参数：运算符，支持以下运算符：like, not like, &gt;, =, &lt;, &gt;=, !=, &lt;=</p></li><li class="list__item" id="-sbnubc_88"><p id="-sbnubc_91">第三个参数：正则表达式（java正则表达式）、值。</p></li></ul></li><li class="list__item" id="-sbnubc_82"><p id="-sbnubc_92">返回：</p><ul class="list _bullet" id="-sbnubc_93"><li class="list__item" id="-sbnubc_94"><p id="-sbnubc_98">如果匹配正则表达式，返回Null，表示过滤该行。不匹配表达式时，表示保留该行。（注意是该行）。对于&gt;=&lt;都是对字段直接compare的结果.</p></li><li class="list__item" id="-sbnubc_95"><p id="-sbnubc_99">like ， not like是将字段转换成String，然后和目标正则表达式进行全匹配。</p></li><li class="list__item" id="-sbnubc_96"><aside class="prompt" data-type="tip" data-title="" id="-sbnubc_100"><p id="-sbnubc_101">, =, &lt;, &gt;=, !=, &lt;= 对于DoubleColumn比较double值，对于LongColumn和DateColumn比较long值，其他StringColumn，BooleanColumn以及ByteColumn均比较的是StringColumn值。</p></aside></li><li class="list__item" id="-sbnubc_97"><p id="-sbnubc_102">如果目标colunn为空（null），对于 = null的过滤条件，将满足条件，被过滤。！=null的过滤条件，null不满足过滤条件，不被过滤。 like，字段为null不满足条件，不被过滤，和not like，字段为null满足条件，被过滤。</p></li></ul></li><li class="list__item" id="-sbnubc_83"><p id="-sbnubc_103">举例：</p></li></ul><div class="code-block" data-lang="none">
dx_filter(1,&quot;like&quot;,&quot;dataTest&quot;)  
dx_filter(1,&quot;&gt;=&quot;,&quot;10&quot;)  
</div><ol class="list _decimal" id="-sbnubc_22" type="1" start="5"><li class="list__item" id="-sbnubc_104"><p id="-sbnubc_105">dx_digest</p></li></ol><ul class="list _bullet" id="-sbnubc_23"><li class="list__item" id="-sbnubc_106"><p id="-sbnubc_109">参数：3个</p><ul class="list _bullet" id="-sbnubc_110"><li class="list__item" id="-sbnubc_111"><p id="-sbnubc_114">第一个参数：字段编号，对应record中第几个字段。</p></li><li class="list__item" id="-sbnubc_112"><p id="-sbnubc_115">第二个参数：hash类型，md5、sha1</p></li><li class="list__item" id="-sbnubc_113"><p id="-sbnubc_116">第三个参数：hash值大小写 toUpperCase（大写）、toLowerCase（小写）</p></li></ul></li><li class="list__item" id="-sbnubc_107"><p id="-sbnubc_117">返回： 返回指定类型的hashHex,如果字段为空，则转为空字符串，再返回对应hashHex</p></li><li class="list__item" id="-sbnubc_108"><p id="-sbnubc_118">举例：</p></li></ul><div class="code-block" data-lang="none">
dx_digest(1,&quot;md5&quot;,&quot;toUpperCase&quot;), column 1的值为 xyzzzzz =&gt; 9CDFFC4FA4E45A99DB8BBCD762ACFFA2
</div><ol class="list _decimal" id="-sbnubc_25" type="1" start="6"><li class="list__item" id="-sbnubc_119"><p id="-sbnubc_120">dx_groovy</p></li></ol><ul class="list _bullet" id="-sbnubc_26"><li class="list__item" id="-sbnubc_121"><p id="-sbnubc_124">参数。</p><ul class="list _bullet" id="-sbnubc_125"><li class="list__item" id="-sbnubc_126"><p id="-sbnubc_128">第一个参数： groovy code</p></li><li class="list__item" id="-sbnubc_127"><p id="-sbnubc_129">第二个参数（列表或者为空）：extraPackage</p></li></ul></li><li class="list__item" id="-sbnubc_122"><p id="-sbnubc_130">备注：</p><ul class="list _bullet" id="-sbnubc_131"><li class="list__item" id="-sbnubc_132"><p id="-sbnubc_136">dx_groovy只能调用一次。不能多次调用。</p></li><li class="list__item" id="-sbnubc_133"><p id="-sbnubc_137">groovy code中支持java.lang, java.util的包，可直接引用的对象有record，以及element下的各种column（BoolColumn.class,BytesColumn.class,DateColumn.class,DoubleColumn.class,LongColumn.class,StringColumn.class）。不支持其他包，如果用户有需要用到其他包，可设置extraPackage，注意extraPackage不支持第三方jar包。</p></li><li class="list__item" id="-sbnubc_134"><p id="-sbnubc_138">groovy code中，返回更新过的Record（比如record.setColumn(columnIndex, new StringColumn(newValue));），或者null。返回null表示过滤此行。</p></li><li class="list__item" id="-sbnubc_135"><p id="-sbnubc_139">用户可以直接调用静态的Util方式（GroovyTransformerStaticUtil），目前GroovyTransformerStaticUtil的方法列表：</p><ul class="list _bullet" id="-sbnubc_140"><li class="list__item" id="-sbnubc_141"><p id="-sbnubc_143">md5(String):String</p></li><li class="list__item" id="-sbnubc_142"><p id="-sbnubc_144">sha1(String):String</p></li></ul></li></ul></li><li class="list__item" id="-sbnubc_123"><p id="-sbnubc_145">举例:</p></li></ul><div class="code-block" data-lang="none">
groovy 实现的subStr:
        String code = &quot;Column column = record.getColumn(1);\n&quot; +
                &quot; String oriValue = column.asString();\n&quot; +
                &quot; String newValue = oriValue.substring(0, 3);\n&quot; +
                &quot; record.setColumn(1, new StringColumn(newValue));\n&quot; +
                &quot; return record;&quot;;
        dx_groovy(record);
</div><div class="code-block" data-lang="none">
groovy 实现的Replace
String code2 = &quot;Column column = record.getColumn(1);\n&quot; +
                &quot; String oriValue = column.asString();\n&quot; +
                &quot; String newValue = \&quot;****\&quot; + oriValue.substring(3, oriValue.length());\n&quot; +
                &quot; record.setColumn(1, new StringColumn(newValue));\n&quot; +
                &quot; return record;&quot;;
</div><div class="code-block" data-lang="none">
groovy 实现的Pad
String code3 = &quot;Column column = record.getColumn(1);\n&quot; +
                &quot; String oriValue = column.asString();\n&quot; +
                &quot; String padString = \&quot;12345\&quot;;\n&quot; +
                &quot; String finalPad = \&quot;\&quot;;\n&quot; +
                &quot; int NeedLength = 8 - oriValue.length();\n&quot; +
                &quot;        while (NeedLength &gt; 0) {\n&quot; +
                &quot;\n&quot; +
                &quot;            if (NeedLength &gt;= padString.length()) {\n&quot; +
                &quot;                finalPad += padString;\n&quot; +
                &quot;                NeedLength -= padString.length();\n&quot; +
                &quot;            } else {\n&quot; +
                &quot;                finalPad += padString.substring(0, NeedLength);\n&quot; +
                &quot;                NeedLength = 0;\n&quot; +
                &quot;            }\n&quot; +
                &quot;        }\n&quot; +
                &quot; String newValue= finalPad + oriValue;\n&quot; +
                &quot; record.setColumn(1, new StringColumn(newValue));\n&quot; +
                &quot; return record;&quot;;
</div></section><section class="chapter"><h2 id="job" data-toc="job">Job定义</h2><ul class="list _bullet" id="-sbnubc_146"><li class="list__item" id="-sbnubc_148"><p id="-sbnubc_149">本例中，配置4个UDF。</p></li></ul><div class="code-block" data-lang="none">
{
    &quot;job&quot;: {
        &quot;setting&quot;: {
            &quot;speed&quot;: {
                &quot;channel&quot;: 1
            },
            &quot;errorLimit&quot;: {
                &quot;record&quot;: 0
            }
        },
        &quot;content&quot;: [
            {
                &quot;reader&quot;: {
                    &quot;name&quot;: &quot;streamreader&quot;,
                    &quot;parameter&quot;: {
                        &quot;column&quot;: [
                            {
                                &quot;value&quot;: &quot;DataX&quot;,
                                &quot;type&quot;: &quot;string&quot;
                            },
                            {
                                &quot;value&quot;: 1724154616370,
                                &quot;type&quot;: &quot;long&quot;
                            },
                            {
                                &quot;value&quot;: &quot;2024-01-01 00:00:00&quot;,
                                &quot;type&quot;: &quot;date&quot;
                            },
                            {
                                &quot;value&quot;: true,
                                &quot;type&quot;: &quot;bool&quot;
                            },
                            {
                                &quot;value&quot;: &quot;TestRawData&quot;,
                                &quot;type&quot;: &quot;bytes&quot;
                            }
                        ],
                        &quot;sliceRecordCount&quot;: 100
                    }
                },
                &quot;writer&quot;: {
                    &quot;name&quot;: &quot;streamwriter&quot;,
                    &quot;parameter&quot;: {
                        &quot;print&quot;: false,
                        &quot;encoding&quot;: &quot;UTF-8&quot;
                    }
                },
                &quot;transformer&quot;: [
                    {
                        &quot;name&quot;: &quot;dx_substr&quot;,
                        &quot;parameter&quot;: {
                            &quot;columnIndex&quot;: 5,
                            &quot;paras&quot;: [
                                &quot;1&quot;,
                                &quot;3&quot;
                            ]
                        }
                    },
                    {
                        &quot;name&quot;: &quot;dx_replace&quot;,
                        &quot;parameter&quot;: {
                            &quot;columnIndex&quot;: 4,
                            &quot;paras&quot;: [
                                &quot;3&quot;,
                                &quot;4&quot;,
                                &quot;****&quot;
                            ]
                        }
                    },
                    {
                        &quot;name&quot;: &quot;dx_digest&quot;,
                        &quot;parameter&quot;: {
                            &quot;columnIndex&quot;: 3,
                            &quot;paras&quot;: [
                                &quot;md5&quot;,
                                &quot;toLowerCase&quot;
                            ]
                        }
                    },
                    {
                        &quot;name&quot;: &quot;dx_groovy&quot;,
                        &quot;parameter&quot;: {
                            &quot;code&quot;: &quot;//groovy code//&quot;,
                            &quot;extraPackage&quot;: [
                                &quot;import somePackage1;&quot;,
                                &quot;import somePackage2;&quot;
                            ]
                        }
                    }
                ]
            }
        ]
    }
}

</div></section><section class="chapter"><h2 id="-sbnubc_7" data-toc="-sbnubc_7">计量和脏数据</h2><p id="-sbnubc_150">Transform过程涉及到数据的转换，可能造成数据的增加或减少，因此更加需要精确度量，包括：</p><ul class="list _bullet" id="-sbnubc_151"><li class="list__item" id="-sbnubc_158"><p id="-sbnubc_163">Transform的入参Record条数、字节数。</p></li><li class="list__item" id="-sbnubc_159"><p id="-sbnubc_164">Transform的出参Record条数、字节数。</p></li><li class="list__item" id="-sbnubc_160"><p id="-sbnubc_165">Transform的脏数据Record条数、字节数。</p></li><li class="list__item" id="-sbnubc_161"><p id="-sbnubc_166">如果是多个Transform，某一个发生脏数据，将不会再进行后面的transform，直接统计为脏数据。</p></li><li class="list__item" id="-sbnubc_162"><p id="-sbnubc_167">目前只提供了所有Transform的计量（成功，失败，过滤的count，以及transform的消耗时间）。</p></li></ul><p id="-sbnubc_152">涉及到运行过程的计量数据展现定义如下：</p><div class="code-block" data-lang="none">
Total 1000000 records, 22000000 bytes | Transform 100000 records(in), 10000 records(out) | Speed 2.10MB/s, 100000 records/s | Error 0 records, 0 bytes | Percentage 100.00%
</div><p id="-sbnubc_154"><span class="control" id="-sbnubc_168">注意，这里主要记录转换的输入输出，需要检测数据输入输出的记录数量变化。</span></p><p id="-sbnubc_155">涉及到最终作业的计量数据展现定义如下：</p><div class="code-block" data-lang="none">
任务启动时刻                    : 2015-03-10 17:34:21
任务结束时刻                    : 2015-03-10 17:34:31
任务总计耗时                    :                 10s
任务平均流量                    :            2.10MB/s
记录写入速度                    :         100000rec/s
转换输入总数		      :             1000000
转换输出总数		      :             1000000
读出记录总数                    :             1000000
同步失败总数                    :                   0
</div><p id="-sbnubc_157"><span class="control" id="-sbnubc_169">注意，这里主要记录转换的输入输出，需要检测数据输入输出的记录数量变化。</span></p></section><div class="last-modified">08 七月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="datax-4-其他.html" class="navigation-links__prev">Previous article</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>